webpackJsonp([26],{PtV2:function(e,t,o){var n=o("CWSs");e.exports={cancelBookingUrl3PX:function(){return n.createAjaxUrl("/biz/3px/cancel_booking")},cancelBookingUrl:function(){return n.createAjaxUrl("/biz/3p/cancel_booking")},get3pLogUrl:function(){return n.createAjaxUrl("biz/3p_log/list")},getRoomPresentSendUrl:function(){return n.createAjaxUrl("biz/3px/present/wine")},getRoomPresentLimitUrl:function(){return n.createAjaxUrl("biz/3px/present/limit")},getGoodsDetailUrl:function(){return n.createAjaxUrl("biz/3p/present/set")},getGoodsListUrl:function(){return n.createAjaxUrl("biz/3px/present/menu")},getRoomOrderUrl:function(){return n.createAjaxUrl("biz/3px/booking")},getRoomDiscountUrl:function(){return n.createAjaxUrl("biz/3px/discount")},getRoomDiscountLimitUrl:function(){return n.createAjaxUrl("biz/3px/discount/limit")},getRoomListUrl:function(){return n.createAjaxUrl("rooms/states")},getRoomListUrl2:function(){return n.createAjaxUrl("biz3/box_states")},getRoomInfoUrl:function(e){return""==e?n.createAjaxUrl("biz3/box_info?companycode="+e):n.createAjaxUrl("biz3/jumpin_box?companycode="+e)},getRoomMemberInfoUrl:function(){return n.createAjaxUrl("nbs/member_info")},getRoomSendWish:function(){return n.createAjaxUrl("biz/wish/info")},getSendWishPageUrl:function(e){return e?"http://www.ktvme.com/bless/merchants":"http://192.168.97.106/bless/merchants?kpm_channel=01230123"},roomStaetConvert:function(e){var t={1:[1,"空闲"],2:[2,"结帐"],7:[2,"结帐"],3:[3,"预订"],4:[4,"锁定"],14:[4,"锁定"],5:[5,"使用"],10:[10,"带客"],12:[12,"故障"],16:[16,"买钟"],17:[17,"清洁"],22:[22,"测机"]};return void 0==t[e]?[0,"非开房"]:t[e]},colorMap:{0:"#000",1:"#7ecae4",7:"#57bc54",2:"#57bc54",4:"#2882d8",5:"#dc5563",3:"#9958b4",6:"#dc5563",8:"#dc5563",9:"#dc5563",10:"#e2551d",12:"#54575d",16:"#fea531",17:"#22BCBC",18:"#dc5563",19:"#dc5563",22:"#AD1488"}}},SfE0:function(e,t,o){e.exports=o.p+"static/img/close.4b33d82.png"},"T+Zd":function(e,t,o){o("e5fG");var n=o("VU/8")(o("i8Qm"),o("pkP3"),"data-v-20f61454",null);e.exports=n.exports},e5fG:function(e,t,o){var n=o("k9qB");"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);o("rjj0")("117fa2cd",n,!0)},gsSi:function(e,t,o){var n=o("e3l2"),r=n.KTVmeBridge,i=o("tpu8"),a=i.memoize(function(){var e={action:"invalid_token",data:""};try{r.webToNativeRequest(e,"nativeHandler")}catch(e){}});e.exports=function(e,t,o){9e4==e.ret?a():o()}},i8Qm:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=o("mvHQ"),r=o.n(n),i=o("bOdI"),a=o.n(i),s=o("I3G/"),l=o.n(s),c=o("mtWM"),d=o.n(c),u=o("1DHf"),m=o.n(u),p=o("rHil"),g=o.n(p),h=o("pDNl"),f=o.n(h),b=o("4K2T"),v=o.n(b),x=o("2sLL"),w=o.n(x),k=o("rLAy"),_=o.n(k),R=o("/kga"),S=o.n(R),j=o("Y+qm"),U=o("PtV2"),A=o("PZHe"),z=o("gsSi"),C=o("e3l2"),O=C.KTVmeBridge;l.a.use(j.a),t.default={components:{Group:g.a,Cell:m.a,XInput:f.a,DatetimeRange:v.a,XButton:w.a,Toast:_.a,XDialog:S.a,LoadingPlugin:j.a},mounted:function(){this.init()},data:function(){var e;return e={user:"",tel:"",date:[],dateE:"",dateS:"",desc:"",onFetching:!1,currentRoomState:{},show2:!1,mes:"",userObj:{},isLogin:!1},a()(e,"mes",""),a()(e,"isRemember",!0),a()(e,"userName",""),a()(e,"passWord",""),a()(e,"show",!1),e},methods:{dateShow:function(){window.scroll(0,0)},init:function(){localStorage.getItem("isRemember")&&"false"==localStorage.getItem("isRemember")?this.isRemember=!1:this.isRemember=!0,this.currentRoomState=JSON.parse(localStorage.getItem("currentRoomState")),console.log(this.currentRoomState),this.date=this.getCurrentTime(!0),this.dateS=this.getCurrentTime(!1),this.dateE=this.getCurrentTime(!1,1),console.log(this.dateS),console.log(this.dateE),localStorage.getItem("userObj")&&(this.userObj=JSON.parse(localStorage.getItem("userObj")),console.log(this.userObj.pass),this.userName=this.userObj.user,this.passWord=this.userObj.pass),document.title=this.currentRoomState.roomName+"包厢预订"},rememberUser:function(){this.isRemember=!this.isRemember,localStorage.setItem("isRemember",this.isRemember)},toLogin:function(){var e=this.user,t=this.tel,o=this.date.join(":").replace(":"," ")+":00",n=this.getCurrentTime(!0).join(":").replace(":"," ")+":00",r=(this.desc,this.userName),i=this.passWord;return console.log(r+"---"+i),console.log(o<n),e&&t&&o?o<n?(this.show2=!0,void(this.mes="预订时间不得小于当前时间!")):/^1[0-9]\d{9}$/.test(t)?void(this.isLogin=!this.isLogin):(this.show2=!0,void(this.mes="手机号码格式不正确!")):(this.show2=!0,void(this.mes="信息填写不完整"))},validation:function(){if(this.userObj={},this.userObj.user=this.userName,this.userObj.pass=this.passWord,""==this.passWord&&(this.mes="请输入密码!"),""==this.userName&&(this.mes="请输入账号!"),""==this.userName||""==this.passWord)return void(this.show=!0);this.isRemember?(localStorage.setItem("userObj",r()(this.userObj)),console.log(this.userObj)):localStorage.removeItem("userObj"),this.toOrder(),this.isLogin=!1},getCurrentTime:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=void 0,n=void 0,r=void 0,i=void 0,a=void 0,s=new Date;o=s.getFullYear(),n=s.getMonth()+1;var l=n+t;return l>12?(n=l%12,o+=Math.floor(l/12)):n=l,o+="-",n=(n<10?"0"+n:n)+"-",r=s.getDate()<10?"0"+s.getDate():s.getDate()+"",i=s.getHours()<10?"0"+s.getHours():s.getHours()+"",a=s.getMinutes()<10?"0"+s.getMinutes():s.getMinutes()+"",s.getSeconds(),e?[o+n+r,i,a]:o+n+r+""},goBack:function(){1==this.currentRoomState.enterpage?history.back():O.closePage({target:""})},toOrder:function(){var e=this;if(!this.onFetching){this.onFetching=!0,console.log("进行预订"),this.isLogin=!1;var t=this.currentRoomState.roomid,o=this.currentRoomState.roomName;A.getCompanyInfo(function(n){var i=n.token,a=n.secid,s=U.getRoomOrderUrl(),l=e.user,c=e.tel,u=e.date.join(":").replace(":"," ")+":00",m=e.getCurrentTime(!0).join(":").replace(":"," ")+":00",p=e.desc,g=e.userName,h=e.passWord;return u<m?(e.show2=!0,void(e.mes="预订时间不得小于当前时间!")):l&&c&&u?(e.$vux.loading.show({text:"加载中"}),void O.encrypt({data:r()({StaffCode:g,guestName:l,guestPhone:c,password:h,remark:p,reserveTime:u,roomID:t,roomName:o}),sign:"1",cb:function(t){0==t.code?(console.log("加密结果:"+t.data),d.a.post(s,{data:t.data},{headers:{"x-auth-token":i,"x-auth-secid":a}}).then(function(t){var o=t.data;z(o,{},function(){console.log("接收数据：",o),e.$vux.loading.hide(),0==o.ret?(e.mes="预订成功",e.user="",e.tel="",e.time=e.getCurrentTime(),e.desc="",e.show2=!0,e.isRemember||(e.userName="",e.passWord=""),setTimeout(function(){e.goBack()},2e3)):(e.mes=o.msg,e.show2=!0,e.isRemember||(e.userName="",e.passWord=""))})}).catch(function(t){e.$vux.loading.hide(),e.mes="服务出现小问题,请稍后再试!!",e.show2=!0,e.isRemember||(e.userName="",e.passWord="")})):(e.$vux.loading.hide(),console.log("加密失败:"+t.msg),e.mes="服务出现小问题,请稍后再试!!!",e.show2=!0)}})):(e.show2=!0,void(e.mes="信息填写不完整"))}),setTimeout(function(){e.onFetching=!1},1e3)}}}}},k9qB:function(e,t,o){t=e.exports=o("FZ+f")(),t.push([e.i,"\n#order[data-v-20f61454] {\n  position: fixed;\n  width: 100%;\n  top: 0;\n}\n#order .weui-cells__title[data-v-20f61454] {\n  font-size: 16px;\n}\n#order .weui-cell[data-v-20f61454] {\n  font-size: 16px;\n}\n#order .btn[data-v-20f61454] {\n  width: 90%;\n  margin-top: 40px;\n  background: #2780F8;\n  color: #FFF;\n  letter-spacing: 5px;\n}\n#order .dialogA[data-v-20f61454] {\n  font-size: 16px;\n  height: 200px;\n  position: absolute;\n  top: 100px;\n  left: 0;\n  width: 100%;\n  z-index: 999;\n}\n#order .dialogA .box[data-v-20f61454] {\n  width: 85%;\n  margin: 0 auto;\n}\n#order .dialogA .box .close[data-v-20f61454] {\n  width: 28px;\n  position: absolute;\n  top: -42px;\n  right: 0px;\n  color: #FFF;\n  z-index: 999;\n}\n#order .dialogA .box .title[data-v-20f61454] {\n  font-size: 16px;\n  text-align: left;\n  margin: 10px 0;\n}\n#order .dialogA .box .remember[data-v-20f61454] {\n  text-align: left;\n  margin: -5px 0 0 0;\n}\n#order .dialogA .box .remember span[data-v-20f61454] {\n  background: #FFF;\n  display: inline-block;\n  width: 14px;\n  height: 14px;\n  border: 1px solid #999;\n  border-radius: 50%;\n  vertical-align: sub;\n  position: relative;\n}\n#order .dialogA .box .remember span img[data-v-20f61454] {\n  width: 10.2px;\n  height: 7.2px;\n  position: absolute;\n  left: 50%;\n  top: 50%;\n  -webkit-transform: translate(-50%, -50%);\n          transform: translate(-50%, -50%);\n}\n#order .dialogA .box .remember .active[data-v-20f61454] {\n  background: #2780F8;\n  border: 1px solid #2780F8;\n}\n#order .dialogA .box p[data-v-20f61454] {\n  width: 100%;\n  position: relative;\n  margin-bottom: 10px;\n}\n#order .dialogA .box p label[data-v-20f61454] {\n  position: absolute;\n  left: 5%;\n  top: 50%;\n  -webkit-transform: translateY(-50%);\n          transform: translateY(-50%);\n  z-index: 9;\n}\n#order .dialogA .box p .input[data-v-20f61454] {\n  padding-left: 20%;\n  border: none;\n  background: #F2F2F2;\n  border-radius: 5px;\n}\n#order .dialogA .dialogBottom[data-v-20f61454] {\n  padding: 15px;\n  padding-top: 5px;\n}\n#order .dialogA .dialogBottom .ok[data-v-20f61454] {\n  height: 40px;\n  line-height: 40px;\n  color: #fff;\n  font-size: 16px;\n  width: 95%;\n  background: #2780F8;\n  border-radius: 5px;\n  margin: 0 auto;\n}\n@media screen and (min-width: 380px) {\n#order .weui-cell[data-v-20f61454] {\n    padding: 15px 20px;\n}\n}\n",""])},mzrW:function(e,t,o){e.exports=o.p+"static/img/tick.fd7ae81.png"},pkP3:function(e,t,o){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"order"}},[n("group",{attrs:{title:"会员信息"}},[n("x-input",{attrs:{title:"会员姓名","show-clear":!1,placeholder:"点击输入",max:8},model:{value:e.user,callback:function(t){e.user=t},expression:"user"}}),e._v(" "),n("x-input",{attrs:{title:"手机号码","show-clear":!1,placeholder:"点击输入",max:11},model:{value:e.tel,callback:function(t){e.tel=t},expression:"tel"}})],1),e._v(" "),n("group",{attrs:{title:"预订信息"}},[n("datetime-range",{attrs:{title:"到店时间","start-date":e.dateS,"end-date":e.dateE,format:" YYYY年MM月DD日"},nativeOn:{click:function(t){return e.dateShow(t)}},model:{value:e.date,callback:function(t){e.date=t},expression:"date"}}),e._v(" "),n("x-input",{attrs:{title:"备注","show-clear":!1,placeholder:"点击输入"},model:{value:e.desc,callback:function(t){e.desc=t},expression:"desc"}})],1),e._v(" "),e.currentRoomState.roomName?n("group",{attrs:{title:"包厢信息"}},[n("x-input",{attrs:{title:"包厢",placeholder:e.currentRoomState.roomName,disabled:!0}}),e._v(" "),n("x-input",{attrs:{title:"房型",placeholder:e.currentRoomState.roomType,disabled:!0}})],1):e._e(),e._v(" "),n("toast",{attrs:{type:"text"},model:{value:e.show2,callback:function(t){e.show2=t},expression:"show2"}},[e._v(e._s(e.mes))]),e._v(" "),n("x-button",{staticClass:"btn",nativeOn:{click:function(t){e.toLogin()}}},[e._v("一键订房")]),e._v(" "),e.isLogin?n("x-dialog",{staticClass:"dialogA",model:{value:e.isLogin,callback:function(t){e.isLogin=t},expression:"isLogin"}},[n("div",{staticClass:"box"},[n("img",{staticClass:"close",attrs:{src:o("SfE0")},on:{click:function(t){e.isLogin=!e.isLogin}}}),e._v(" "),n("p",{staticClass:"title"},[e._v("请输入管理系统账号密码")]),e._v(" "),n("p",[n("label",{attrs:{for:"user"}},[e._v("账号")]),e._v(" "),n("x-input",{staticClass:"input",attrs:{"show-clear":!1,id:"user",max:16,type:"text",value:""},model:{value:e.userName,callback:function(t){e.userName=t},expression:"userName"}})],1),e._v(" "),n("p",[n("label",{attrs:{for:"pass"}},[e._v("密码")]),e._v(" "),n("x-input",{staticClass:"input",attrs:{"show-clear":!1,id:"pass",max:16,type:"password",value:""},model:{value:e.passWord,callback:function(t){e.passWord=t},expression:"passWord"}})],1),e._v(" "),n("p",{staticClass:"remember",on:{click:e.rememberUser}},[n("span",{class:{active:e.isRemember}},[n("img",{attrs:{src:o("mzrW"),alt:""}})]),e._v(" 记住密码\n\t\t\t")])]),e._v(" "),n("toast",{attrs:{type:"text"},model:{value:e.show,callback:function(t){e.show=t},expression:"show"}},[e._v(e._s(e.mes))]),e._v(" "),n("div",{staticClass:"dialogBottom"},[n("div",{staticClass:"ok",on:{click:e.validation}},[e._v("\n\t\t\t\t提交\n\t\t\t")]),e._v(" "),n("div",{staticStyle:{clear:"both"}})])],1):e._e()],1)},staticRenderFns:[]}}});